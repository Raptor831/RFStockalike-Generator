!function(e){function s(){e(window).width()>600&&(e("#primary-navigation .menu").removeAttr("style"),e("#mobile-menu-button").removeClass("has-open"))}function n(){s()}function r(){e(document).click(function(s){if(-1==e(s.target).parents().index(e("#primary-navigation"))&&-1==e(s.target).parents().index(e("#mobile-menu-button"))){e(".has-open").length>0&&e(".menu-item-has-children.has-open .sub-menu").fadeOut(100).parent(".has-open").removeClass("has-open");var n=e("#mobile-menu-button");n.hasClass("has-open")&&(e("ul#menu-primary-navigation").fadeOut(100),n.removeClass("has-open"))}}),e(".menu-item-has-children > a").click(function(s){s.preventDefault(),e(this).siblings(".sub-menu").fadeToggle(100),e(this).parent().siblings(".menu-item-has-children.has-open").each(function(){e(this).removeClass("has-open").find(".sub-menu").fadeOut(100),e(this).find(".menu-item-has-children.has-open").removeClass("has-open")}),e(this).parent().toggleClass("has-open")}),e(document).click(function(s){if(-1==e(s.target).parents().index(e("#primary-navigation"))&&-1==e(s.target).parents().index(e("#mobile-menu-button"))){e(".has-open").length>0&&e(".menu-item-has-children.has-open .sub-menu").fadeOut(100).parent(".has-open").removeClass("has-open");var n=e("#mobile-menu-button");n.hasClass("has-open")&&(e("ul#menu-primary-navigation").fadeOut(100),n.removeClass("has-open"))}}),e("#mobile-menu-button").click(function(s){s.preventDefault(),e("#primary-navigation .menu").fadeToggle(100),e(this).toggleClass("has-open")})}function i(){e("body").on("click","button#select",function(s){s.preventDefault(),e("#selectable").click(),t("selectable")})}function t(e){var s;document.selection?(s=document.body.createTextRange(),s.moveToElementText(document.getElementById(e)),s.select()):window.getSelection&&(window.getSelection().removeAllRanges(),s=document.createRange(),s.selectNode(document.getElementById(e)),window.getSelection().addRange(s))}var f;window.onresize=function(){f&&clearTimeout(f);var e;e=setTimeout(function(){n()},200)},e(window).load(function(){n()}),e(document).ready(function(){r(),i()})}(jQuery),angular.module("rfstockalikeServices",[]).factory("rfstockalikeConstants",function(){var e={thrustCurves:{0:"",1:"key = 0.00000 0.01000 0 0\r\n        key = 0.00077 0.01000 0 0\r\n        key = 0.01234 0.15000\r\n        key = 0.05089 0.50000\r\n        key = 0.11642 0.85000\r\n        key = 0.19352 1.00000 0 0\r\n        key = 0.27062 1.00000 0 0\r\n        key = 0.34618 0.98000\r\n        key = 0.41557 0.90000\r\n        key = 0.47957 0.83000\r\n        key = 0.53816 0.76000\r\n        key = 0.59368 0.72000\r\n        key = 0.64611 0.68000\r\n        key = 0.69545 0.64000\r\n        key = 0.74171 0.60000\r\n        key = 0.78543 0.56700\r\n        key = 0.82652 0.53300\r\n        key = 0.86507 0.50000\r\n        key = 0.90170 0.47500\r\n        key = 0.93639 0.45000\r\n        key = 0.96916 0.42500\r\n        key = 1.00000 0.40000",2:"key = 0.00000 0.01000 0 0\r\n        key = 0.00058 0.01000 0 0\r\n        key = 0.00927 0.15000\r\n        key = 0.03824 0.50000\r\n        key = 0.08749 0.85000\r\n        key = 0.14542 1.00000 0 0\r\n        key = 0.20336 1.00000 0 0\r\n        key = 0.26130 1.00000 0 0\r\n        key = 0.31924 1.00000 0 0\r\n        key = 0.37717 1.00000 0 0\r\n        key = 0.43511 1.00000 0 0\r\n        key = 0.49305 1.00000 0 0\r\n        key = 0.55098 1.00000 0 0\r\n        key = 0.60892 1.00000 0 0\r\n        key = 0.66686 1.00000 0 0\r\n        key = 0.72480 1.00000 0 0\r\n        key = 0.78273 1.00000 0 0\r\n        key = 0.84067 1.00000 0 0\r\n        key = 0.89861 1.00000 0 0\r\n        key = 0.95365 0.95000\r\n        key = 1.00000 0.80000",3:"key = 0.00000 0.01000 0 0\r\n        key = 0.00041 0.01000 0 0\r\n        key = 0.00244 0.05000\r\n        key = 0.00652 0.10000\r\n        key = 0.01467 0.20000\r\n        key = 0.02689 0.30000\r\n        key = 0.04523 0.45000\r\n        key = 0.07253 0.67000\r\n        key = 0.11125 0.95000\r\n        key = 0.15200 1.00000 0 0\r\n        key = 0.19275 1.00000 0 0\r\n        key = 0.23227 0.97000\r\n        key = 0.27058 0.94000\r\n        key = 0.30807 0.92000\r\n        key = 0.34474 0.90000\r\n        key = 0.38060 0.88000\r\n        key = 0.41606 0.87000\r\n        key = 0.45110 0.86000\r\n        key = 0.48574 0.85000\r\n        key = 0.51997 0.84000\r\n        key = 0.55420 0.84000\r\n        key = 0.58883 0.85000\r\n        key = 0.62388 0.86000\r\n        key = 0.65933 0.87000\r\n        key = 0.69519 0.88000\r\n        key = 0.73187 0.90000\r\n        key = 0.76936 0.92000\r\n        key = 0.80766 0.94000\r\n        key = 0.84719 0.97000\r\n        key = 0.88794 1.00000 0 0\r\n        key = 0.92869 1.00000 0 0\r\n        key = 0.96740 0.95000\r\n        key = 1.00000 0.80000",4:"key = 0.00000 0.01000 0 0\r\n        key = 0.00057 0.01000 0 0\r\n        key = 0.00905 0.15000\r\n        key = 0.02658 0.31000\r\n        key = 0.04581 0.34000\r\n        key = 0.06674 0.37000\r\n        key = 0.08937 0.40000\r\n        key = 0.11369 0.43000\r\n        key = 0.13971 0.46000\r\n        key = 0.16742 0.49000\r\n        key = 0.19683 0.52000\r\n        key = 0.22794 0.55000\r\n        key = 0.26075 0.58000\r\n        key = 0.29525 0.61000\r\n        key = 0.33145 0.64000\r\n        key = 0.36934 0.67000\r\n        key = 0.40894 0.70000\r\n        key = 0.45023 0.73000\r\n        key = 0.49321 0.76000\r\n        key = 0.53790 0.79000\r\n        key = 0.58428 0.82000\r\n        key = 0.63235 0.85000\r\n        key = 0.68213 0.88000\r\n        key = 0.73360 0.91000\r\n        key = 0.78676 0.94000\r\n        key = 0.84163 0.97000\r\n        key = 0.89819 1.00000 0 0\r\n        key = 0.95475 1.00000 0 0\r\n        key = 1.00000 0.80000",5:"key = 0.00000 0.01000 0 0\r\n        key = 0.00058 0.01000 0 0\r\n        key = 0.00930 0.15000\r\n        key = 0.02733 0.31000\r\n        key = 0.04709 0.34000\r\n        key = 0.06860 0.37000\r\n        key = 0.09186 0.40000\r\n        key = 0.11686 0.43000\r\n        key = 0.14360 0.46000\r\n        key = 0.17209 0.49000\r\n        key = 0.20233 0.52000\r\n        key = 0.23430 0.55000\r\n        key = 0.26802 0.58000\r\n        key = 0.30291 0.60000\r\n        key = 0.33895 0.62000\r\n        key = 0.37616 0.64000\r\n        key = 0.41453 0.66000\r\n        key = 0.45407 0.68000\r\n        key = 0.49477 0.70000\r\n        key = 0.53663 0.72000\r\n        key = 0.57965 0.74000\r\n        key = 0.62558 0.79000\r\n        key = 0.67442 0.84000\r\n        key = 0.72616 0.89000\r\n        key = 0.78081 0.94000\r\n        key = 0.83721 0.97000\r\n        key = 0.89535 1.00000 0 0\r\n        key = 0.95349 1.00000 0 0\r\n        key = 1.00000 0.80000",6:"key = 0.00000 0.01000 0 0\r\n        key = 0.00065 0.01000 0 0\r\n        key = 0.00523 0.07000\r\n        key = 0.01504 0.15000\r\n        key = 0.03139 0.25000\r\n        key = 0.04774 0.25000\r\n        key = 0.06409 0.25000\r\n        key = 0.08044 0.25000\r\n        key = 0.09680 0.25000\r\n        key = 0.11315 0.25000\r\n        key = 0.12950 0.25000\r\n        key = 0.14585 0.25000\r\n        key = 0.16220 0.25000\r\n        key = 0.17855 0.25000\r\n        key = 0.19490 0.25000\r\n        key = 0.21125 0.25000\r\n        key = 0.22760 0.25000\r\n        key = 0.24395 0.25000\r\n        key = 0.26030 0.25000\r\n        key = 0.27665 0.25000\r\n        key = 0.29300 0.25000\r\n        key = 0.31131 0.28000\r\n        key = 0.33290 0.33000\r\n        key = 0.36560 0.50000\r\n        key = 0.41465 0.75000\r\n        key = 0.47351 0.90000\r\n        key = 0.53630 0.96000\r\n        key = 0.60105 0.99000\r\n        key = 0.66645 1.00000 0 0\r\n        key = 0.73185 1.00000 0 0\r\n        key = 0.79660 0.99000\r\n        key = 0.85939 0.96000\r\n        key = 0.91825 0.90000\r\n        key = 0.96730 0.75000\r\n        key = 1.00000 0.50000"},thrustCurveNames:{0:"Stock",1:"Increasing",2:"Steady",3:"SteadyDip",4:"Decreasing",5:"DecreasingDip",6:"PulseSteady"},launchIsp:{start:[234,260,44.7,67,1,1,null,1],1:[248,275,54.2,81.25,1.15,.95,1.21,1],2:[266,295,66.8,100.25,1.32,.88,1.23,1],3:[279,310,76.3,114.5,1.43,.84,1.14,1],4:[288,320,82.7,124,1.5,.81,1.08,.8],5:[295,327,87.1,130.65,1.55,.8,1.05,.7],6:[299,332,90.3,135.4,1.58,.78,1.04,.6],7:[304,337,93.4,140.15,1.61,.77,1.03,.6]},launchPlusIsp:{start:[220,268,38.3,53.6,1,1,null,1],1:[233,283,46.4,65,1.15,.95,1.21,1],2:[250,304,57.3,80.2,1.32,.88,1.23,.8],3:[262,319,65.4,91.6,1.43,.84,1.14,.75],4:[271,330,70.9,99.2,1.5,.81,1.08,.7],5:[277,337,74.6,104.5,1.55,.8,1.05,.65],6:[281,342,77.4,108.3,1.58,.78,1.04,.6],7:[285,347,80.1,112.1,1.62,.77,1.03,.5]},upperIsp:{start:[168,280,35.2,44,1,1,null,1],1:[185,308,48.8,61,1.26,.91,1.39,1],2:[195,325,56.8,71,1.39,.86,1.16,1],3:[201,335,61.6,77,1.46,.84,1.08,1],4:[204,340,64,80,1.5,.82,1.04,.8],5:[207,345,66.4,83,1.53,.81,1.04,.75],6:[210,350,68.8,86,1.56,.8,1.04,.7],7:[213,355,71.2,89,1.6,.79,1.03,.6]},upperPlusIsp:{start:[102,291,25.4,30.47,1,1,null,1],1:[112,320,38.5,46.2,1.38,.91,1.52,1],2:[118,338,46.2,55.47,1.57,.86,1.2,.75],3:[122,348,50.9,61.02,1.68,.84,1.1,.4],4:[124,354,53.2,63.81,1.72,.82,1.05,.3],5:[126,359,55.5,66.59,1.77,.81,1.04,.2],6:[127,364,57.8,69.36,1.82,.8,1.04,.15],7:[129,369,60.1,72.14,1.87,.79,1.04,.1]},orbitalIsp:{start:[100,286,18.9,21.71,1,1,null,1],1:[110,314,25.8,29.71,1.24,.91,1.37,1],2:[116,332,30.3,34.86,1.38,.86,1.17,.75],3:[120,342,32.8,37.71,1.45,.84,1.08,.4],4:[121,347,34,39.14,1.48,.82,1.04,.2],5:[123,352,35.3,40.57,1.52,.81,1.04,.15],6:[125,357,36.5,42,1.55,.8,1.03,.1],7:[127,362,37.8,43.43,1.58,.79,1.04,.1]},solidIsp:{start:[200,220,4.347826087,23,1],1:[215,235,5.263157895,19,1],2:[230,250,6.25,16,1],3:[240,260,7.142857143,14,1],4:[245,268,8.333333333,12,1],5:[255,276,10,10,1],6:[260,284,11.11111111,9,1],7:[265,290,12.5,8,1]},solidPlusIsp:{start:[160,231,4.761904762,21,1],1:[172,247,5.882352941,17,1],2:[184,263,7.142857143,14,1],3:[192,273,8.333333333,12,1],4:[196,281,10,10,1],5:[204,290,12.5,8,1],6:[208,298,14.28571429,7,1],7:[212,305,16.66666667,6,1]},nuclearIsp:{3:[380,850,1.46,1.679,1,1,null,1],4:[391,875,2,2.3,1.33,.97,1.37,1],5:[407,910,2.4241,2.787715,1.55,.93,1.21,1],6:[416,930,4,4.6,2.5,.91,1.65,1],7:[429,960,6,6.9,3.64,.89,1.5,1],8:[452,1010,8,9.2,4.61,.84,1.33,1]},aerospikeIsp:{start:[252,280,20.7,28.94175,1,1,null,1],1:[277,308,31.4,43.89,1.38,.91,1.52,1],2:[293,325,37.6,52.6965,1.56,.86,1.2,.8],3:[302,335,41.4,57.969,1.67,.84,1.1,.7],4:[306,340,43.3,60.6195,1.72,.82,1.05,.6],5:[311,345,45.2,63.25575,1.77,.81,1.04,.5],6:[315,350,47.1,65.892,1.82,.8,1.04,.4],7:[320,355,48.9,68.52825,1.86,.79,1.04,.3]},rcsIsp:{start:[351,366,44.7,67,1,1,null,1],1:[370,390,54.2,81.25,1.15,.95,1.21,1],2:[399,416,66.8,100.25,1.32,.88,1.23,1],3:[418,437,76.3,114.5,1.43,.84,1.14,1],4:[432,451,82.7,124,1.5,.81,1.08,.8],5:[442,461,87.1,130.65,1.55,.8,1.05,.7],6:[448,468,90.3,135.4,1.58,.78,1.04,.6],7:[456,475,93.4,140.15,1.61,.77,1.03,.6]},rcsDefaultConfigs:[{config_mixture:135,config_ratio:0,config_tech_node:""},{config_mixture:134,config_ratio:0,config_tech_node:""},{config_mixture:178,config_ratio:1.6,config_tech_node:""},{config_mixture:138,config_ratio:0,config_tech_node:""},{config_mixture:137,config_ratio:0,config_tech_node:""},{config_mixture:177,config_ratio:2,config_tech_node:""},{config_mixture:180,config_ratio:1.7,config_tech_node:""},{config_mixture:888,config_ratio:0,config_tech_node:""}]};return e.engineTypeConfigs={launch:["L",e.launchIsp,1,!1,!1],"launch-plus":["L+",e.launchPlusIsp,2,!1,!1],upper:["U",e.upperIsp,4,!1,!1],"upper-plus":["U+",e.upperPlusIsp,12,!0,!1],orbital:["O",e.orbitalIsp,24,!0,!0],"nuclear-thermal":["N",e.nuclearIsp,0,!1,!1],solid:["S",e.solidIsp,1,!0,!1],"solid-plus":["S+",e.solidPlusIsp,1,!0,!1],aerospike:["A",e.aerospikeIsp,0,!0,!1],jet:["J",null,0,!0,!1],rcs:["L",e.rcsIsp,0,!0,!0]},e}).factory("rfengineServices",["rfstockalikeConstants",function(e){return{cleanData:function(e,s){if(e.ksprfs.ksprfs_engine_mefx="on"===e.ksprfs.ksprfs_engine_mefx||1==e.ksprfs.ksprfs_engine_mefx?!0:!1,e.ksprfs.ksprfs_engine_bimodal="on"===e.ksprfs.ksprfs_engine_bimodal||1==e.ksprfs.ksprfs_engine_bimodal?!0:!1,e.ksprfs.ksprfs_engine_ffsc="on"===e.ksprfs.ksprfs_engine_ffsc||1==e.ksprfs.ksprfs_engine_ffsc?!0:!1,e.ksprfs.ksprfs_engine_dedicated="on"===e.ksprfs.ksprfs_engine_dedicated||1==e.ksprfs.ksprfs_engine_dedicated?!0:!1,e.ksprfs.ksprfs_engine_pressure_fed="on"===e.ksprfs.ksprfs_engine_pressure_fed||1==e.ksprfs.ksprfs_engine_pressure_fed?!0:!1,e.ksprfs.ksprfs_engine_vectoring_override="on"===e.ksprfs.ksprfs_engine_vectoring_override||1==e.ksprfs.ksprfs_engine_vectoring_override?!0:!1,e.ksprfs.ksprfs_engine_vectoring_exists="on"===e.ksprfs.ksprfs_engine_vectoring_exists||1==e.ksprfs.ksprfs_engine_vectoring_exists?!0:!1,e.ksprfs.ksprfs_engine_vectoring=parseInt(e.ksprfs.ksprfs_engine_vectoring)?parseInt(e.ksprfs.ksprfs_engine_vectoring):0,e.ksprfs.ksprfs_engine_type&&!e.ksprfs.ksprfs_type){var n=s.getType(e.ksprfs.ksprfs_engine_type[0]);e.ksprfs.ksprfs_type=n?n.slug:"launch"}e.ksprfs.ksprfs_engine_flow||(e.ksprfs.ksprfs_engine_flow="STACK_PRIORITY_SEARCH"),e.ksprfs.ksprfs_engine_ignition_mode=e.ksprfs.ksprfs_engine_ignition_mode.toString(),e.ksprfs.ksprfs_engine_tech_level=e.ksprfs.ksprfs_engine_tech_level.toString(),"undefined"==typeof e.ksprfs.ksprfs_engine_pressure_fed&&(e.ksprfs.ksprfs_engine_pressure_fed=!1)},prepareSaveData:function(e,s){e.ksprfs.ksprfs_engine_mefx=e.ksprfs.ksprfs_engine_mefx===!0?"on":null,e.ksprfs.ksprfs_engine_bimodal=e.ksprfs.ksprfs_engine_bimodal===!0?"on":null,e.ksprfs.ksprfs_engine_ffsc=e.ksprfs.ksprfs_engine_ffsc===!0?"on":null,e.ksprfs.ksprfs_engine_dedicated=e.ksprfs.ksprfs_engine_dedicated===!0?"on":null,e.ksprfs.ksprfs_engine_pressure_fed=e.ksprfs.ksprfs_engine_pressure_fed===!0?"on":null,e.ksprfs.ksprfs_engine_vectoring_override=e.ksprfs.ksprfs_engine_vectoring_override===!0?"on":null,e.ksprfs.ksprfs_engine_vectoring_exists=e.ksprfs.ksprfs_engine_vectoring_exists===!0?"on":null,e.ksprfs.ksprfs_engine_type||(e.ksprfs.ksprfs_engine_type=[]),e.ksprfs.ksprfs_engine_type[0]=s.getTypeBySlug(e.ksprfs.ksprfs_type).id.toString()},doTWR:function(s,n){s.ksprfs.engine_twr=s.ksprfs.ksprfs_engine_thrust/9.81/s.ksprfs.ksprfs_engine_mass;var r,i,t,f,p;if(t=s.ksprfs.ksprfs_engine_ispslm<1?.9:4,f=s.ksprfs.ksprfs_engine_ispvm<1?1.5:8,p=s.ksprfs.ksprfs_engine_ffsc?1.33:1,r=Math.min(Math.max(Math.pow(s.ksprfs.ksprfs_engine_ispslm,t),.5),10),i=Math.min(Math.max(Math.pow(s.ksprfs.ksprfs_engine_ispvm,f),.5),10),s.ksprfs.engine_gtwr=e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][2]/r/i*p,s.ksprfs.engine_twr>.95*s.ksprfs.engine_gtwr&&s.ksprfs.engine_twr<1.05*s.ksprfs.engine_gtwr?s.ksprfs.engine_twr_within_goal=!0:s.ksprfs.engine_twr_within_goal=!1,"solid"===s.ksprfs.ksprfs_type||"solid-plus"===s.ksprfs.ksprfs_type){s.ksprfs.ksprfs_engine_mft_volume&&0!==s.ksprfs.ksprfs_engine_mft_volume&&"0"!==s.ksprfs.ksprfs_engine_mft_volume||n.errors.push("No tank volume specified."),s.ksprfs.engine_goal_percent_case=1/s.ksprfs.engine_gtwr*100;var o=parseFloat(s.ksprfs.ksprfs_engine_extra_mass)||0,k=s.ksprfs.ksprfs_engine_mass+o,a=.00178*s.ksprfs.ksprfs_engine_mft_volume+k;s.ksprfs.engine_percent_case=k/a*100,s.ksprfs.engine_percent_case>.95*s.ksprfs.engine_goal_percent_case&&s.ksprfs.engine_percent_case<1.05*s.ksprfs.engine_goal_percent_case?s.ksprfs.engine_percent_case_within_goal=!0:s.ksprfs.engine_percent_case_within_goal=!1}switch(s.ksprfs.ksprfs_engine_throttle_type){case"full-throttle":s.finalThrottle=0;break;case"unthrottleable":s.finalThrottle=-1;break;case"use-default":s.finalThrottle=e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][7];break;case"use-default-tech":var g=n.engine.ksprfs.ksprfs_engine_throttle_tl;"start"===g&&(g="0"),s.finalThrottle=g,parseInt(s.finalThrottle)||(s.finalThrottle=0);break;case"custom-throttle":s.finalThrottle=Math.round(s.ksprfs.ksprfs_engine_throttle*e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][7]*1e3)/1e3,parseFloat(s.finalThrottle)||(s.finalThrottle=0);break;default:s.finalThrottle=0}"rcs"===s.ksprfs.ksprfs_type&&(s.finalThrottle=0)},doIsp:function(s){var n,r;n=e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][1]*s.ksprfs.ksprfs_engine_ispvm,r=e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][0]*s.ksprfs.ksprfs_engine_ispslm,s.ksprfs.ksprfs_engine_ffsc&&(n*=1.07,r*=1.07),s.ksprfs.resultIspV=n,s.ksprfs.resultIspSL=r},doHeat:function(s){var n,r;if("solid"===s.ksprfs.ksprfs_type||"solid-plus"===s.ksprfs.ksprfs_type?(n=Math.pow(s.ksprfs.ksprfs_engine_mft_volume*s.ksprfs.resultIspV/4/9.81/s.ksprfs.ksprfs_engine_thrust+20,.75),s.ksprfs.engine_heat=Math.round(.5*(200+5200/n))):(n=135*Math.pow(s.ksprfs.resultIspSL/200,.7)*Math.pow(s.ksprfs.engine_twr/s.ksprfs.engine_gtwr,.5),"nuclear-thermal"===s.ksprfs.ksprfs_type&&(n*=1.25),s.ksprfs.engine_heat=n),"solid"!==s.ksprfs.ksprfs_type&&"solid-plus"!==s.ksprfs.ksprfs_type){var i;r=e.engineTypeConfigs[s.ksprfs.ksprfs_type][1][s.ksprfs.ksprfs_engine_tech_level][6],i=Math.pow(500+8*n/r,1.03),s.ksprfs.max_heat=Math.max(1450,Math.min(2400,i))}else s.ksprfs.max_heat=1800;s.ksprfs.max_heat=Math.round(s.ksprfs.max_heat,0)},doConfigs:function(s,n){var r;for(r=0;r<s.ksprfs.ksprfs_engine_configs.length;r++){s.ksprfs.ksprfs_engine_configs[r].config_mixture=parseInt(s.ksprfs.ksprfs_engine_configs[r].config_mixture);var i,t=n.getMixture(s.ksprfs.ksprfs_engine_configs[r].config_mixture),f=n.getFuel(t).ksprfs.ksprfs_resource_density;n.getOxidizer(t)&&(i=n.getOxidizer(t).ksprfs.ksprfs_resource_density);var p=s.ksprfs.ksprfs_engine_configs[r].config_ratio;n.getOxidizer(t)?(s.ksprfs.ksprfs_engine_configs[r].fuelRatio=1/f/(1/f+p/i)*100,s.ksprfs.ksprfs_engine_configs[r].oxyRatio=100-s.ksprfs.ksprfs_engine_configs[r].fuelRatio):s.ksprfs.ksprfs_engine_configs[r].fuelRatio=100;var o,k;o=k=1,o=t.ksprfs.ksprfs_mixture_ispv_mult,k=t.ksprfs.ksprfs_mixture_ispsl_mult,s.ksprfs.ksprfs_engine_ffsc&&(o*=1.07,k*=1.07),s.ksprfs.ksprfs_engine_configs[r].ispV_mult=o*s.ksprfs.ksprfs_engine_ispvm,s.ksprfs.ksprfs_engine_configs[r].ispSL_mult=k*s.ksprfs.ksprfs_engine_ispslm;var a,g,l;a=s.ksprfs.ksprfs_engine_ignitions,g=parseInt(s.ksprfs.ksprfs_engine_ignition_mode),"undefined"==typeof a&&""!==a&&(a=0),l=g>1?a:t.ksprfs.ksprfs_mixture_hypergolic?a:1,s.ksprfs.ksprfs_engine_configs[r].ignitions=l,"solid"===s.ksprfs.ksprfs_type||"solid-plus"===s.ksprfs.ksprfs_type?(s.ksprfs.ksprfs_engine_configs[r].ullage=!1,s.ksprfs.ksprfs_engine_configs[r].ignitions=1):s.ksprfs.ksprfs_engine_configs[r].ullage=!0,s.ksprfs.ksprfs_engine_configs[r].ignitionsPart=s.ksprfs.ksprfs_engine_configs[r].ignitions?Math.abs(s.ksprfs.ksprfs_engine_configs[r].ignitions):-1,0>a&&(s.ksprfs.ksprfs_engine_configs[r].ignitionsPart=Math.max(1,parseInt(this.displayTechLevel(s))+a)),s.ksprfs.ksprfs_engine_configs[r].title=JSON.parse(JSON.stringify(t.title)),s.ksprfs.ksprfs_engine_configs[r].config_thrust_curve&&"0"!=s.ksprfs.ksprfs_engine_configs[r].config_thrust_curve&&("-1"===s.ksprfs.ksprfs_engine_configs[r].config_thrust_curve?s.ksprfs.ksprfs_engine_configs[r].title.rendered+="Custom"+(r+1):s.ksprfs.ksprfs_engine_configs[r].title.rendered+=e.thrustCurveNames[s.ksprfs.ksprfs_engine_configs[r].config_thrust_curve])}},doCost:function(e){var s,n,r=1.5;s=.8*e.ksprfs.resultIspV+.2*e.ksprfs.resultIspSL-200,s=Math.pow(s,2)*e.ksprfs.ksprfs_engine_thrust/1e3*(1+.2*Math.abs(e.ksprfs.ksprfs_engine_vectoring)),"jet"===e.ksprfs.ksprfs_type&&(s*=.05),"nuclear-thermal"===e.ksprfs.ksprfs_type&&(s*=4),e.ksprfs.ksprfs_engine_ffsc&&(s*=.5),n=s>0?s*(Math.pow(s/e.ksprfs.ksprfs_engine_mass/4e3),.25)*.5+50+70*e.ksprfs.ksprfs_engine_mass:0,e.ksprfs.engineCost=Math.round(n*r);var i=e.ksprfs.ksprfs_engine_ffsc?10:5;e.ksprfs.engineEntryCost=e.ksprfs.engineCost*i},displayTechLevel:function(e){var s=e.ksprfs.ksprfs_engine_tech_level;return"start"===s&&(s="0"),s}}}]),angular.module("rfstockalikeBase",[]).controller("RFBaseController",["$scope","$http","$filter",function(e,s,n){e.errors=[],e.successes=[],e.enginesList=[],e.engines=[],e.mods=[],e.types=[],e.resources=[],e.mixtures=[],e.math=Math,e.mods.length<1&&s.get("/wp-json/wp/v2/engine-mod/?per_page=100").success(function(s){e.setMods(s)}),e.setEngines=function(s){e.engines=s},e.setEnginesList=function(s){e.enginesList=s},e.setEngine=function(s){e.engine=s},e.setMixtures=function(s){e.mixtures=s},e.setMods=function(s){e.mods=s},e.setTypes=function(s){e.types=s},e.setResources=function(s){e.resources=s},e.getFuel=function(s){return e.getResource(s.ksprfs.ksprfs_mixture_fuel)},e.getOxidizer=function(s){return e.getResource(s.ksprfs.ksprfs_mixture_oxidizer)},e.getResource=function(s){return s=parseInt(s),n("filter")(e.resources,function(e){return e.id===s})[0]},e.getMixture=function(s){return s=parseInt(s),n("filter")(e.mixtures,function(e){return e.id===s})[0]},e.getType=function(s){return s=parseInt(s),n("filter")(e.types,function(e){return e.id===s})[0]},e.getTypeBySlug=function(s){return n("filter")(e.types,function(e){return e.slug===s})[0]},e.getSingleEngine=function(s){return n("filter")(e.engines,function(e){return parseInt(e.id)===parseInt(s)})[0]}}]),angular.module("rfstockalikeEngines",["rfstockalikeServices","ngSanitize"]).controller("RFEngineController",["$scope","$http","$q","$filter","$stateParams","rfengineServices","rfstockalikeConstants",function(e,s,n,r,i,t,f){e.constants=f,e.rfengineServices=t,e.doCalcs=function(s){e.errors=[],e.successes=[],t.doIsp(s),t.doTWR(s,e),t.doHeat(s),t.doConfigs(s,e),t.doCost(s)},e.defaultIgnitions=function(s){s.ksprfs.ksprfs_engine_ignitions=f.engineTypeConfigs[s.ksprfs.ksprfs_type][2],f.engineTypeConfigs[s.ksprfs.ksprfs_type][3]?s.ksprfs.ksprfs_engine_ignition_mode="2":s.ksprfs.ksprfs_engine_ignition_mode="1",f.engineTypeConfigs[s.ksprfs.ksprfs_type][2]&&e.doCalcs(s)},e.rcsDefault=function(s){s.ksprfs.ksprfs_engine_configs=f.rcsDefaultConfigs,s.ksprfs.ksprfs_engine_tech_level="1",s.ksprfs.ksprfs_engine_ispvm=1,s.ksprfs.ksprfs_engine_ispslm=1,s.ksprfs.ksprfs_engine_ignition_mode="0",s.ksprfs.ksprfs_engine_flow="STAGE_PRIORITY_FLOW",e.rcsMass(s)},e.rcsMass=function(s){s.ksprfs.ksprfs_rcs_nozzles||(s.ksprfs.ksprfs_rcs_nozzles=4),s.ksprfs.ksprfs_engine_mass=(s.ksprfs.ksprfs_rcs_nozzles*s.ksprfs.ksprfs_engine_thrust*6+5)/1e3,e.doCalcs(s)},e.addConfig=function(e){e.ksprfs.ksprfs_engine_configs.push({config_mixture:0,config_ratio:0,config_tech_node:""})},e.removeConfig=function(e,s){e.ksprfs.ksprfs_engine_configs.splice(s,1)},e.changeTitle=function(e){var s=window.prompt("Change Title To...","");null!==s&&""!==s&&(e.title.rendered=s,window.console.log(e.title))},e.saveEngine=function(n){t.prepareSaveData(n,e);var r=[];e.successes=[],e.errors=[],angular.forEach(n.ksprfs,function(e,s){r.push({key:s,value:e})});var i="/wp-json/wp/v2/engines/";"undefined"!=typeof n.id&&(i+=n.id);var f={method:"PUT",url:i,transformResponse:function(e,s){return e},data:{ID:n.ID,title:n.title,ksprfs:r}};s(f).success(function(){e.successes.push("Engine saved!")}).error(function(){e.errors.push("Unable to save engine. Be sure you are logged in properly, and try again.")}),t.cleanData(n)},e.submitEngine=function(n){n.engineMod=window.prompt("Mod for this engine:",""),t.prepareSaveData(n);var r={method:"POST",url:"/engine-submit/",data:n};s(r).success(function(){e.successes.push("Engine submitted!")}).error(function(){e.errors.push("Unable to submit engine. Please try again.")}),t.cleanData(n)},e.createEngine=function(n){var r=[];e.successes=[],e.errors=[],angular.forEach(n.ksprfs,function(e,s){r.push({key:s,value:e})});var i={method:"POST",url:"/wp-json/wp/v2/engines",headers:{"X-WP-Nonce":RFS.nonce},data:{title:n.title.rendered,type:"engine",status:"publish",ksprfs:r}};s(i).success(function(){e.successes.push("Engine submitted!")}).error(function(){e.errors.push("Unable to submit engine. Please try again.")})},e.parseField=function(){e.parsed=angular.fromJson(e.engine),window.console.log(e.parsed)};var p=i.id;e.loading=!0;var o=[];if(e.engines.length<1&&0!==parseInt(p)){var k=s.get("/wp-json/wp/v2/engines/"+p).success(function(s){e.setEngine(s),t.cleanData(e.engine,e)});o.push(k)}else if(0===parseInt(p)){var k=s.get("/wp-content/themes/rfstockalike/data/blank.json").success(function(s){e.setEngine(s),t.cleanData(e.engine,e)});o.push(k)}else e.setEngine(e.getSingleEngine(p)),console.log(e.engines),t.cleanData(e.engine,e);if(e.mixtures.length<1){var k=s.get("/wp-json/wp/v2/mixtures/?per_page=100").success(function(s){e.setMixtures(s)});o.push(k)}if(e.types.length<1){var k=s.get("/wp-json/wp/v2/engine-type/?per_page=100").success(function(s){e.setTypes(s)});o.push(k)}if(e.resources.length<1){var k=s.get("/wp-json/wp/v2/resources/?per_page=100").success(function(s){e.setResources(s)});o.push(k)}o.length>0?n.all(o).then(function(){e.loading=!1,e.doCalcs(e.engine)}):(e.loading=!1,e.doCalcs(e.engine))}]).controller("RFEngineListController",["$scope","$http","$q","$filter","$timeout","$window","rfengineServices",function(e,s,n,r,i,t,f){if(e.rfengineServices=f,e.currentPage=0,e.pageSize=20,e.loading=!0,e.prepareEngineList=function(e){var s={};s.title=e.title.rendered,s.link=e.link,s.id=e.id,s.type=e.ksprfs.ksprfs_type;var n=[];return angular.forEach(e.ksprfs.ksprfs_engine_configs,function(e,s){n.push(e.config_mixture)}),s.configs=n,s},e.ceil=function(e){return Math.ceil(e)},e.checkPage=function(){i(function(){e.filteredEngines.length/e.pageSize<e.currentPage&&(e.currentPage=0)},200)},e.mixtures.length<1&&s.get("/wp-json/wp/v2/mixtures/?per_page=100&filter[order]=ASC&filter[orderby]=title").success(function(s){e.setMixtures(s)}),e.enginesList.length<1){var p="/wp-json/wp/v2/engines/?per_page="+e.pageSize,o=[];s.get(p).success(function(r,i,t){angular.forEach(r,function(s,n){e.engines.push(s),e.enginesList.push(e.prepareEngineList(s))}),e.engineCount=t("X-WP-Total");var f=Math.ceil(e.engineCount/e.pageSize),k=2;for(k;f>=k;k++){var a=s.get(p+"&page="+k).success(function(s){angular.forEach(s,function(s,n){e.engines.push(s),e.enginesList.push(e.prepareEngineList(s))})});o.push(a)}n.all(o).then(function(){e.loading=!1})})}else e.loading=!1}]).controller("RFSingleModController",["$scope","$http","$q","$filter","$stateParams","rfengineServices","rfstockalikeConstants",function(e,s,n,r,i,t,f){e.constants=f,e.rfengineServices=t,e.doCalcs=function(s){e.errors=[],e.successes=[],t.doIsp(s),t.doTWR(s,e),t.doHeat(s),t.doConfigs(s,e),t.doCost(s)},e.loading=!0;var p=[];if(e.mixtures.length<1){var o=s.get("/wp-json/wp/v2/mixtures/?per_page=100").success(function(s){e.setMixtures(s)});p.push(o)}if(e.types.length<1){var o=s.get("/wp-json/wp/v2/engine-type/?per_page=100").success(function(s){e.setTypes(s)});p.push(o)}if(e.resources.length<1){var o=s.get("/wp-json/wp/v2/resources/?per_page=100").success(function(s){e.setResources(s)});p.push(o)}if(e.engines.length<1){var o=s.get("/wp-json/wp/v2/engines/?per_page=100&filter[engine_mod]="+i.slug).success(function(s){e.modEngines=s,window.console.log(e.modEngines)});p.push(o)}else e.modEngines=r("filter")(e.engines,function(e){return 0!==e.ksprfs_taxonomy.engine_mod.length?e.ksprfs_taxonomy.engine_mod[0].slug===i.slug:void 0});p.length>0?n.all(p).then(function(){e.loading=!1,angular.forEach(e.modEngines,function(s,n){t.cleanData(s,e),window.console.log("engine"),e.doCalcs(s)})}):angular.forEach(e.modEngines,function(s,n){t.cleanData(s,e),window.console.log("engine"),e.doCalcs(s)})}]),angular.module("rfsApp",["ui.router","rfstockalikeBase","rfstockalikeEngines"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,s,n){s.otherwise("/home"),e.state("tabs",{url:"/","abstract":!0,templateUrl:RFS.partials+"tabs.html",controller:"RFBaseController"}).state("tabs.home",{url:"home",views:{"main-tab":{templateUrl:RFS.partials+"home.html"}}}).state("tabs.engines",{url:"engines",views:{"main-tab":{templateUrl:RFS.partials+"engine-list.html",controller:"RFEngineListController"}}}).state("tabs.singleEngine",{url:"engines/:id",views:{"main-tab":{templateUrl:RFS.partials+"engine-single.html",controller:"RFEngineController"}}}).state("tabs.mods",{url:"mods",views:{"main-tab":{templateUrl:RFS.partials+"mods.html"}}}).state("tabs.singleMod",{url:"mods/:slug",views:{"main-tab":{templateUrl:RFS.partials+"mods-single.html",controller:"RFSingleModController"}}}),n.interceptors.push([function(){return{request:function(e){return e.headers=e.headers||{},e.headers["X-WP-Nonce"]=RFS.nonce,e}}}])}]).directive("rfConfig",function(){return{templateUrl:RFS.partials+"engine-config.html"}}).filter("startFrom",function(){return function(e,s){return s=+s,e.length<s?e.slice(0):e.slice(s)}});